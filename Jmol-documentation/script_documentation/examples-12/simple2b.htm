<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title>JSmol -- platform-aware Jmol using jQuery</title>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />

<!-- 

JSmoljQuery.js 			  required
JSmolCore.js					essential; add next in the order given here
JSmolApplet.js				essential
JSmolControls.js			required for any interactivity
JSmolApi.js						essential
JSmol.js							required
-->


<script type="text/javascript" src="jsmol/JSmol.min.js"></script>
<script type="text/javascript">
//<![CDATA[

// simple2.htm: demonstration of using platform-aware Jmol with jQuery
// author: Bob Hanson hansonr@stolaf.edu 8/11/2012 8:21:03 AM

// ---------------------------------------------------------------------------------

////// special stuff just for this particular page

var s = unescape(document.location.search);
var xxxx = s.split("USE=")[0]
script = ""
if (xxxx.length == 0) {
	xxxx = "ethanol"
	script = 'set errorCallback "myCallback";'
	+'set zoomlarge false;set echo top left;echo loading XXXX...;refresh;'
	+'load ":XXXX";set echo top center;echo XXXX;'
	+''
	script = script.replace(/XXXX/g, xxxx)
} else {
	script = unescape(xxxx.substring(1))
}

var use = "JAVA HTML5 IMAGE"
if (s.indexOf("USE=") >= 0)
  use = s.split("USE=")[1].split("&")[0]
else if (s.indexOf("JAVA") >= 0)
  use = "JAVA"
else if (s.indexOf("IMAGE") >= 0)
  use = "IMAGE"
else if (s.indexOf("NOWEBGL") >= 0)
  use = "JAVA IMAGE"
else if (s.indexOf("WEBGL") >= 0)
  use = "WEBGL HTML5"
if (s.indexOf("NOWEBGL") >= 0)
  use = use.replace(/WEBGL/,"")
var useSignedApplet = (s.indexOf("SIGNED") >= 0);

  
var useSignedApplet = true;//(document.location.href.indexOf("SIGNED") >= 0);


// ---------------------------------------------------------------------------------

////// every page will need one variable and one Info object for each applet object
var Info1 = {
	width: 300,
	height: 300,
	script: script,
	use: use,
	jarPath: ".",
	j2sPath: "jsmol/j2s",
	jarFile: (useSignedApplet ? "JmolAppletSigned.jar" : "JmolApplet.jar"),
	isSigned: useSignedApplet,
	addSelectionOptions: false,
	serverURL: "http://chemapps.stolaf.edu/jmol/jsmol/jsmol.php",
	readyFunction: null,
	disableInitialConsole: true,
	defaultModel: null,
	debug: false
}


var Info2 = {
	width: 300,
	height: 300,
	script: script,
	use: use,
	jarPath: ".",
	j2sPath: "jsmol/j2s",
	jarFile: (useSignedApplet ? "JmolAppletSigned.jar" : "JmolApplet.jar"),
	isSigned: useSignedApplet,
	addSelectionOptions: false,
	serverURL: "http://chemapps.stolaf.edu/jmol/jsmol/jsmol.php",
	readyFunction: null,
	disableInitialConsole: true,
	defaultModel: null,
	debug: false
}


	// this next bit just allows us to see what platform we are on
	// based on our decisions indicated in Info

	// "true" here indicates just a check

	var appletCheck = Jmol.getApplet("test", Info1, true);
	var isApplet = (appletCheck._jmolType.indexOf("_Applet") >= 0);
	var is2D = appletCheck._is2D;

	if (!isApplet && !Info1.script) {

		// JSmol or image

		Info1.defaultModel = "$tylenol";
		Info1.script = "#alt:LOAD :tylenol";

		Info2.defaultModel = "$tylenol";
		Info2.script = "#alt:LOAD :tylenol";

	}


var jmol1 = "jmol1"; // the JavaScript applet object
var jmol2 = "jmol2"; // the JavaScript applet object

// The actual applet will be jmol._applet (if it turns out to be an actual Applet),
// but we will never access that directly.

$(document).ready(function(){	
	
	// set Jmol to simply create the code and not use document.write
	
	Jmol.setDocument(0);
	// now we have a JavaScript Object "jmol" and jmol._code is the HTML
	// we will need later
	
	// This demonstration shows that
	// what is put on the page can depend upon the platform.

  // It may seem strange or uncessary in what is below to use the syntax  
	// 
	//  Jmol.jmolXXXX(jmol,...)
	//
	// instead of just 
	//
	//  jmol.XXXX(...)
	//
	// This was an intentional design decision. 
	// The reason has to do with flexibility, organization, and legacy:
	// 
	// It allows us to be much more flexible in that jmol is allowed to be just the string "jmol"
	// (which allows us to create controls on the page before the applet wrapper object is created
	//  when using more traditional in-body scripting if we are not interested in platforms).
	//
	// It allowed me to put all the controls in (optional) Jmol.controls, which is a bit cleaner
	// than just having all the controls in the jmol applet wrapper prototype (which would be OK, 
	// but would require copying, possibly with modification, in the case we have other 
	// related prototypes such as glMol, ChemDoodle, JSpecView, or JME
	//
	// It allows users of Jmol.js to easily migrate to this system -- just add "Jmol." in front of 
	// the legacy call jmolXXXX(...) and add the applet reference as the first parameter.
	// 
	// Note that the use of $(document.ready()) is completely optional. 
	// You can do the traditional in-body coding if you want. See also simple2-nojq.htm.
	// But as Gusts Kaksis pointed out, if we are using jQuery for database lookups, we might
	// as well use it for more than that. 
	// If you do not use $(document.ready()), be sure to define jmol this way:
	//
	// jmol = "jmol"
	//
	// prior to calling any of the methods that create controls -- jmolButton, jmolLink, etc.
	// and, if you do that, realize that you cannot implement any platform-aware features. 
	//
  
  var radios = [
		["set background white", "white", true],
		["set background black", "black"]
		];

  // the HTML code is in jmol._code since we are using Jmol.setDocument(0)
  

  // right panel
  
	$("#rightpanel1").html(getPanelCode(jmol1, "right"));  
	$("#rightpanel2").html(getPanelCode(jmol2, "right"));  
	
	// lower panel:
			
	$("#lowerpanel1").html(getPanelCode(jmol1, "lower"));
	$("#lowerpanel2").html(getPanelCode(jmol2, "lower"));
})

  function getPanelCode(jmol, where) {
  switch (where) {
  case "lower":
  	Jmol.setButtonCss(null,"style='width:90px'");
    var s = "<br />"
  		+ Jmol.jmolButton(jmol,"wireframe -0.1 #alt:SETTING Line", "wireframe")
		  + Jmol.jmolButton(jmol,"spacefill only;spacefill 23%;wireframe 0.15 #alt:SETTING Ball and Stick","ball&stick");
		s += Jmol.jmolButton(jmol,"spacefill #alt:SETTING van der Waals Spheres", "spacefill");	
		Jmol.setButtonCss(null,"style='width:80px'");
		s += "<br />"
    s += Jmol.jmolButton(jmol,"console");
    s += Jmol.jmolCommandInput(jmol, null, 30);
    return s;
  case "right":
  	Jmol.setButtonCss(null, "style='width:160px'");	
		return Jmol.jmolButton(jmol,"if (!molname) { molname = 'tylenol'};var x = prompt('Enter the name or identifier (SMILES, InChI, CAS) of a molecule',molname);if (!x) { quit }; molname = x; load @{'$' + molname} #alt:LOAD $??Enter a model name","Load MOL (NCI)")
		+ "<br />"
		+ Jmol.jmolButton(jmol,"if (!molname) { molname = 'tylenol'};var x = prompt('Enter the name of a compound',molname);if (!x) { quit }; molname = x; load @{':' + molname} #alt:LOAD :??Enter a model name","Load MOL (PubChem)")
		+ (isApplet ? 
  		"<br />"
  		+ Jmol.jmolButton(jmol,(isApplet ? "minimize" : "set forceField UFF;minimize"),"Minimize (MMFF94)")
		: "")
 		+ (isApplet ?
  		"<br />"
  		+ Jmol.jmolButton(jmol,"load ? ","Load URL")
  		+ "<br />"
  		+ Jmol.jmolButton(jmol,"load ? ","Load FILE")
  		+ "<br />"
  		+ Jmol.jmolButton(jmol,"script ?.spt","Load SCRIPT")
		: "")
		+ "<br /><br />"
		+ Jmol.jmolButton(jmol,"select *;if ($s1) {isosurface s1 delete} else {calculate partialcharge;isosurface s1 vdw map MEP translucent}","show/hide MEP")
		+ "<br /><br />"
		+ (isApplet ?
  		Jmol.jmolButton(jmol,"show NMR","Predict NMR")
  		+ "<br /><br />"
  		+ Jmol.jmolButton(jmol,"write FILE ?","Save FILE")
  		+ "<br />"
  		+ Jmol.jmolButton(jmol,"write PNGJ ?.png","Save PNG")
  		+ "<br /><br /><a href=simple2b.htm?USE=HTML5>HTML5 version</a>"
		: "<br /><br /><a href=javascript:Jmol.showInfo(" + jmol._id + ",true);>show info</a>")
	}
}
//]]>

</script>
</head>
<body>
<table style="margin-left:auto; margin-right:auto;">
	<tr>
		<td><div id="leftpanel1"></div></td>
		<td><div id="middlepanel1">
		<script type="text/javascript">
			Jmol.getApplet("jmol1", Info1);
		</script>
		</div></td>
		<td><div id="rightpanel1"></div></td>
		<td><div id="leftpanel2"></div></td>
		<td><div id="middlepanel2">
		<script type="text/javascript">
			Jmol.getApplet("jmol2", Info2);
		</script>
		</div></td>
		<td><div id="rightpanel2"></div></td>
	</tr>
	<tr>
		<td></td>
		<td style="text-align:center"><div id="lowerpanel1"></div></td>
		<td></td>
		<td></td>
		<td style="text-align:center"><div id="lowerpanel2"></div></td>
		<td></td>
	</tr>
</table>
<div id="console"></div>
</body>
</html>