<html>
<title>Jmol/ChemDoodle Demo -- Using JmolData.jar for serving ChemDoodle models</title>
<head>
<script type="text/javascript" src="json2.js"></script>
<script type="text/javascript" src="ChemDoodleWeb-libs.js"></script>
<script type="text/javascript" src="ChemDoodleWeb-unpacked.js"></script>
<script type="text/javascript" src="Jmol.js"></script>
<script type="text/javascript" src="JmolCore.js"></script>
<script type="text/javascript" src="JmolApi.js"></script>
<script type="text/javascript" src="JmolCD.js"></script>

<script type="text/javascript">

// note; json2 is necessary for MSIE compatibility
  
var jmolApplet0; // set up in HTML table, below

// logic is set as follows:
//  -- if Java is present and have Jmol.js, use Jmol
//  -- otherwise, if WebGL is present and have ChemDoodleWeb.js, use ChemDoodle/WebGL
//  -- otherwise, if ChemDoodleWeb.js is present, use ChemDoodle/2D
//  -- otherwise, just display the image

// ?USECD or ?USEIMAGE in the URL can force one or the other of these.

// and, of course, a little tweaking of the logic would let you do anything

var useJmolOnly = (document.location.href.indexOf("NOCD") >= 0);
var useChemDoodleOnly = (!useJmolOnly && document.location.href.indexOf("CD") >= 0);
var useWebGlIfAvailable = (document.location.href.indexOf("NOWEBGL") < 0);
var useImageOnly = (document.location.href.indexOf("IMAGE") >= 0);
var useSignedApplet = (document.location.href.indexOf("SIGNED") >= 0);
  
jmol_isReady = function(app,appFull,isReady) {
	if (!isReady) return;
	Jmol.search(jmolApplet0,Info.defaultModel);
}		

var Info = {
	width: 300,
	height: 300,
	debug: true,
	defaultModel: "morphine",
	addSelectionOptions: true,
	serverURL: "http://chemapps.stolaf.edu/jmol/jmolcd2.php",
	useChemDoodleOnly: useChemDoodleOnly,
	useJmolOnly: useJmolOnly,
	useWebGlIfAvailable: useWebGlIfAvailable,
	useImageOnly: useImageOnly,
	jmolJarPath: ".",
	jmolJarFile: (useSignedApplet ? "JmolAppletSigned.jar" : "JmolApplet.jar"),
	jmolIsSigned: useSignedApplet,
	jmolReadyFunctionName: "jmol_isReady"
}

</script>
</head>
<body>
<table width=1000 cellpadding=10>
<tr><td colspan=2>
This Jmol page should automatically switch to different modes
depending upon browser capabilities. It can use the signed Jmol applet, the unsigned Jmol applet
with server-side help, and ChemDoodle with or without WebGL. 
On the server side, it uses JmolData.jar 
for delivering cross-domain models into ChemDoodle or the unsigned applet. It is the first page of its kind.

</td></tr>
<tr><td>

<script>

// note that the variable name MUST match the first parameter in quotes

jmolApplet0 = Jmol.getApplet("jmolApplet0", Info)

</script>

<br><a href="javascript:Jmol.showInfo(jmolApplet0, true)">show info</a>
<a href="javascript:Jmol.showInfo(jmolApplet0, false)">hide info</a>

</td><td valign=top>
Just enter a molecule name, a CAS registry number, an IUPAC name, or some other sort of identifier in the box
and press [ENTER]. Note that these input controls can be easily hidden for a more standard Jmol look.
<br /><br /> 

Current status: (4/20/12) Small molecules loading from PubChem not working with xhr2 without server relay;
ChemDoodle not loading ligand CIF files <a href="javascript:Jmol.loadFile(jmolApplet0,'==HEM')">(==HEM)</a>;
ChemDoodle without WebGL very slow at loading PDB files. 
  
<br /><br /> 
<table cellpadding=5><tr><td valign=top>
<b>rendering options:</b> 
	 <br /> 
  <a href=test2.htm>unsigned Jmol applet</a> 
 <br /> 
<a href=test2.htm?SIGNED>signed Jmol applet</a>
 <br /> 
 <a href=test2.htm?CD>ChemDoodle only</a> 
  <br /> 
<a href=test2.htm?CD-NOWEBGL>not ChemDoodle(no WebGL)</a> 
 <br /> 
<a href=test2.htm?NOCD>not ChemDoodle</a> 
 <br /> 
 <a href=test2.htm?IMAGE>image only</a>
</td><td valign=top>
	<b>this-domain calls - no server</b> 
 <br /> 
 <a href="javascript:Jmol.loadFile(jmolApplet0,'caffeine.mol')">load caffeine.mol</a>
 <br /> 
 <a href="javascript:Jmol.loadFile(jmolApplet0,'1crn.pdb',';cartoons only;color structure;spin on')">load 1crn.pdb</a>
 <br /> 
 <a href="javascript:Jmol.loadFile(jmolApplet0,'t-butene.xyz')">load t-butene.xyz</a>
 <br /> 
 <a href="javascript:Jmol.loadFile(jmolApplet0,'sebi0105c.ccdc.cif')">load sebi0105c.ccdc.cif</a>
 <br /> 
 <a href="javascript:Jmol.loadFile(jmolApplet0,'sucrose.cif')">load sucrose.cif</a>
 <br /> 
 <a href="javascript:Jmol.loadFile(jmolApplet0,'y1237.cif', '{1 1 1}')">load y1237.cif</a>
 <br /> 
 <a href="javascript:Jmol.loadFile(jmolApplet0,'quartz.cif', '{1 1 1}')">load quartz.cif</a>
 </td><td valign=top>
	<b>keyword searches</b> 
 <br /> 
 <a href="javascript:Jmol.search(jmolApplet0,'=caffeine?')">=caffeine? (RCSB)</a>
 <br /> 
 <a href="javascript:Jmol.search(jmolApplet0,'=1blu?')">=1blu? (RCSB)</a>
 <br /> 
 <a href="javascript:Jmol.search(jmolApplet0,'=1crn?')">=1crn? (RCSB)</a>
 <br />
 <br />
	<b>direct database calls - no server</b> 
 <br />
 <a href="javascript:Jmol.loadFile(jmolApplet0,'$caffeine')">load $caffeine (from NCI)</a>
 <br /> 
 <a href="javascript:Jmol.loadFile(jmolApplet0,'=1blu',';cartoons only;color structure')">load =1blu (cartoon, from RCSB)</a>
 <br /> 
 <br /> 
	<b>problems</b> 
 <br />
 <a href="javascript:Jmol.loadFile(jmolApplet0,'==HEM')">load ==HEM (fails in ChemDoodle)</a>
 <br /> 
 <a href="javascript:Jmol.loadFile(jmolApplet0,'http://pubchem.ncbi.nlm.nih.gov/summary/summary.cgi?cid=1983&disopt=3DDisplaySDF')">load :tylenol (not working)</a>
 <br /> 
 <a href="javascript:Jmol.search(jmolApplet0,':caffeine',';isosurface vdw map mep translucent')">:caffeine (indirect PubChem, with mep)</a>

</td></tr></table>
</td>
</tr></table>
</body>
</html>